spring.application.name=aggregate-service

management.server.port=8081
management.server.address=0.0.0.0
management.endpoints.web.exposure.include=health,info,prometheus
management.endpoint.health.probes.enabled=true
management.health.livenessstate.enabled=true
management.health.readinessstate.enabled=true
management.prometheus.metrics.export.enabled=true
management.metrics.tags.application=${spring.application.name}

# Postgres
spring.datasource.url=jdbc:postgresql://${POSTGRES_HOST:iot-postgres}:${POSTGRES_PORT:5432}/${POSTGRES_DB:iotdb}
spring.datasource.username=${POSTGRES_USER:postgres}
spring.datasource.password=${POSTGRES_PASSWORD:postgres}
spring.datasource.type=com.zaxxer.hikari.HikariDataSource
spring.datasource.hikari.pool-name=Hikari-${spring.application.name}
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.initialization-fail-timeout=0

spring.flyway.enabled=true
spring.flyway.schemas=iot_agg
spring.flyway.default-schema=iot_agg
spring.flyway.create-schemas=true
spring.flyway.locations=classpath:db/migration/aggregate

# Aggregation knobs
agg.window=MINUTE
agg.delay-seconds=20
agg.catchup-on-start=true

logging.level.org.springframework.scheduling=DEBUG
